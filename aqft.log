                                                                            »
 q_0: ──────────────────────────────────────────────────────────────────────»
                                                                            »
 q_1: ──────────────────────────────────────────────────────────────────────»
                                                                            »
 q_2: ──────────────────────────────────────────────────────────────────────»
                                                                            »
 q_3: ──────────────────────────────────────────────────────────────────────»
                                                                            »
 q_4: ──────────────────────────────────────────────────────────────────────»
                                                                            »
 q_5: ──────────────────────────────────────────────────────────────────────»
                                                                            »
 q_6: ──────────────────────────────────────────────────────────────────────»
                                                                            »
 q_7: ──────────────────────────────────────────────────────────────────────»
                                                                            »
 q_8: ──────────────────────────────────────────────────────────────────────»
                                                                            »
 q_9: ──────────────────────────────────────────────────────────────────────»
                                                                            »
q_10: ─────────────────────────────────────────────────────────────■────────»
                                                                   │        »
q_11: ──────────────────────────────────────■─────────────■────────┼────────»
                                            │       ┌───┐ │        │        »
q_12: ────────────────────■────────■────────┼───────┤ H ├─┼────────┼────────»
                    ┌───┐ │        │P(π/2)  │       └───┘ │P(π/4)  │        »
q_13: ──────■───────┤ H ├─┼────────■────────┼─────────────■────────┼────────»
      ┌───┐ │P(π/2) └───┘ │P(π/4)           │P(π/8)                │P(π/16) »
q_14: ┤ H ├─■─────────────■─────────────────■──────────────────────■────────»
      └───┘                                                                 »
«                                                                            »
« q_0: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_1: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_2: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_3: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_4: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_5: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_6: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_7: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_8: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_9: ───────────────────■───────────────────────■──────────────────■───────»
«                         │                       │                  │       »
«q_10: ──────────■────────┼──────────────■────────┼─────────■────────┼───────»
«                │        │        ┌───┐ │        │         │P(π/2)  │       »
«q_11: ─■────────┼────────┼────────┤ H ├─┼────────┼─────────■────────┼───────»
«       │P(π/2)  │        │        └───┘ │P(π/4)  │                  │P(π/8) »
«q_12: ─■────────┼────────┼──────────────■────────┼──────────────────■───────»
«                │P(π/8)  │                       │P(π/16)                   »
«q_13: ──────────■────────┼───────────────────────■──────────────────────────»
«                         │P(π/32)                                           »
«q_14: ───────────────────■──────────────────────────────────────────────────»
«                                                                            »
«                                                                         »
« q_0: ───────────────────────────────────────────────────────────────────»
«                                                                         »
« q_1: ───────────────────────────────────────────────────────────────────»
«                                                                         »
« q_2: ───────────────────────────────────────────────────────────────────»
«                                                                         »
« q_3: ───────────────────────────────────────────────────────────────────»
«                                                                         »
« q_4: ───────────────────────────────────────────────────────────────────»
«                                                                         »
« q_5: ───────────────────────────────────────────────────────────────────»
«                                                                         »
« q_6: ───────────────────────────────────────────────────────────────────»
«                                                                         »
« q_7: ─────────────────────────────────────────────────────■─────────────»
«                                                           │             »
« q_8: ─■───────────────────────■──────────────────■────────┼─────────────»
«       │                       │                  │        │        ┌───┐»
« q_9: ─┼──────────────■────────┼─────────■────────┼────────┼────────┤ H ├»
«       │        ┌───┐ │        │         │P(π/2)  │        │        └───┘»
«q_10: ─┼────────┤ H ├─┼────────┼─────────■────────┼────────┼─────────────»
«       │        └───┘ │P(π/4)  │                  │P(π/8)  │             »
«q_11: ─┼──────────────■────────┼──────────────────■────────┼─────────────»
«       │                       │P(π/16)                    │P(π/32)      »
«q_12: ─┼───────────────────────■───────────────────────────■─────────────»
«       │P(π/32)                                                          »
«q_13: ─■─────────────────────────────────────────────────────────────────»
«                                                                         »
«q_14: ───────────────────────────────────────────────────────────────────»
«                                                                         »
«                                                                             »
« q_0: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_1: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_2: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_3: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_4: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_5: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_6: ──────────────────────────────────────■───────────────────────■────────»
«                                            │                       │        »
« q_7: ──────────■──────────────────■────────┼──────────────■────────┼────────»
«                │                  │        │        ┌───┐ │        │        »
« q_8: ─■────────┼─────────■────────┼────────┼────────┤ H ├─┼────────┼────────»
«       │        │         │P(π/2)  │        │        └───┘ │P(π/4)  │        »
« q_9: ─┼────────┼─────────■────────┼────────┼──────────────■────────┼────────»
«       │P(π/4)  │                  │P(π/8)  │                       │P(π/16) »
«q_10: ─■────────┼──────────────────■────────┼───────────────────────■────────»
«                │P(π/16)                    │P(π/32)                         »
«q_11: ──────────■───────────────────────────■────────────────────────────────»
«                                                                             »
«q_12: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_13: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_14: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«                                                                            »
« q_0: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_1: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_2: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_3: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_4: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
« q_5: ───────────────────■───────────────────────■──────────────────■───────»
«                         │                       │                  │       »
« q_6: ──────────■────────┼──────────────■────────┼─────────■────────┼───────»
«                │        │        ┌───┐ │        │         │P(π/2)  │       »
« q_7: ─■────────┼────────┼────────┤ H ├─┼────────┼─────────■────────┼───────»
«       │P(π/2)  │        │        └───┘ │P(π/4)  │                  │P(π/8) »
« q_8: ─■────────┼────────┼──────────────■────────┼──────────────────■───────»
«                │P(π/8)  │                       │P(π/16)                   »
« q_9: ──────────■────────┼───────────────────────■──────────────────────────»
«                         │P(π/32)                                           »
«q_10: ───────────────────■──────────────────────────────────────────────────»
«                                                                            »
«q_11: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
«q_12: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
«q_13: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
«q_14: ──────────────────────────────────────────────────────────────────────»
«                                                                            »
«                                                                         »
« q_0: ───────────────────────────────────────────────────────────────────»
«                                                                         »
« q_1: ───────────────────────────────────────────────────────────────────»
«                                                                         »
« q_2: ───────────────────────────────────────────────────────────────────»
«                                                                         »
« q_3: ─────────────────────────────────────────────────────■─────────────»
«                                                           │             »
« q_4: ─■───────────────────────■──────────────────■────────┼─────────────»
«       │                       │                  │        │        ┌───┐»
« q_5: ─┼──────────────■────────┼─────────■────────┼────────┼────────┤ H ├»
«       │        ┌───┐ │        │         │P(π/2)  │        │        └───┘»
« q_6: ─┼────────┤ H ├─┼────────┼─────────■────────┼────────┼─────────────»
«       │        └───┘ │P(π/4)  │                  │P(π/8)  │             »
« q_7: ─┼──────────────■────────┼──────────────────■────────┼─────────────»
«       │                       │P(π/16)                    │P(π/32)      »
« q_8: ─┼───────────────────────■───────────────────────────■─────────────»
«       │P(π/32)                                                          »
« q_9: ─■─────────────────────────────────────────────────────────────────»
«                                                                         »
«q_10: ───────────────────────────────────────────────────────────────────»
«                                                                         »
«q_11: ───────────────────────────────────────────────────────────────────»
«                                                                         »
«q_12: ───────────────────────────────────────────────────────────────────»
«                                                                         »
«q_13: ───────────────────────────────────────────────────────────────────»
«                                                                         »
«q_14: ───────────────────────────────────────────────────────────────────»
«                                                                         »
«                                                                             »
« q_0: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_1: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_2: ──────────────────────────────────────■──────────────────■─────────────»
«                                            │                  │             »
« q_3: ──────────■──────────────────■────────┼─────────■────────┼─────────────»
«                │                  │        │         │        │        ┌───┐»
« q_4: ─■────────┼─────────■────────┼────────┼─────────┼────────┼────────┤ H ├»
«       │        │         │P(π/2)  │        │         │P(π/4)  │        └───┘»
« q_5: ─┼────────┼─────────■────────┼────────┼─────────■────────┼─────────────»
«       │P(π/4)  │                  │P(π/8)  │                  │P(π/16)      »
« q_6: ─■────────┼──────────────────■────────┼──────────────────■─────────────»
«                │P(π/16)                    │P(π/32)                         »
« q_7: ──────────■───────────────────────────■────────────────────────────────»
«                                                                             »
« q_8: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_9: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_10: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_11: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_12: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_13: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_14: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«                                                                             »
« q_0: ─────────────────────────────────────────────────────■─────────────────»
«                                                           │                 »
« q_1: ──────────■──────────────────■───────────────────────┼─────────────────»
«                │                  │                       │                 »
« q_2: ─■────────┼──────────────────┼──────────────■────────┼─────────■───────»
«       │        │                  │        ┌───┐ │        │         │P(π/2) »
« q_3: ─┼────────┼─────────■────────┼────────┤ H ├─┼────────┼─────────■───────»
«       │        │         │P(π/2)  │        └───┘ │P(π/4)  │                 »
« q_4: ─┼────────┼─────────■────────┼──────────────■────────┼─────────────────»
«       │P(π/8)  │                  │P(π/16)                │P(π/32)          »
« q_5: ─■────────┼──────────────────■───────────────────────■─────────────────»
«                │P(π/32)                                                     »
« q_6: ──────────■────────────────────────────────────────────────────────────»
«                                                                             »
« q_7: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_8: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
« q_9: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_10: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_11: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_12: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_13: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«q_14: ───────────────────────────────────────────────────────────────────────»
«                                                                             »
«                                                                           »
« q_0: ────────────────────────■──────────────────■─────────────────■───────»
«                              │                  │         ┌───┐   │       »
« q_1: ─■─────────────■────────┼─────────■────────┼─────────┤ H ├───┼───────»
«       │       ┌───┐ │        │         │P(π/2)  │         └───┘   │P(π/4) »
« q_2: ─┼───────┤ H ├─┼────────┼─────────■────────┼─────────────────■───────»
«       │       └───┘ │P(π/4)  │                  │P(π/8) ┌───────┐         »
« q_3: ─┼─────────────■────────┼──────────────────■───────┤ cut_1 ├─────────»
«       │P(π/8)                │P(π/16) ┌───────┐         └───────┘         »
« q_4: ─■──────────────────────■────────┤ cut_0 ├───────────────────────────»
«                                       └───────┘                           »
« q_5: ─────────────────────────────────────────────────────────────────────»
«                                                                           »
« q_6: ─────────────────────────────────────────────────────────────────────»
«                                                                           »
« q_7: ─────────────────────────────────────────────────────────────────────»
«                                                                           »
« q_8: ─────────────────────────────────────────────────────────────────────»
«                                                                           »
« q_9: ─────────────────────────────────────────────────────────────────────»
«                                                                           »
«q_10: ─────────────────────────────────────────────────────────────────────»
«                                                                           »
«q_11: ─────────────────────────────────────────────────────────────────────»
«                                                                           »
«q_12: ─────────────────────────────────────────────────────────────────────»
«                                                                           »
«q_13: ─────────────────────────────────────────────────────────────────────»
«                                                                           »
«q_14: ─────────────────────────────────────────────────────────────────────»
«                                                                           »
«                 ┌───┐  ┌───────┐
« q_0: ─■─────────┤ H ├──┤ cut_4 ├
«       │P(π/2) ┌─┴───┴─┐└───────┘
« q_1: ─■───────┤ cut_3 ├─────────
«      ┌───────┐└───────┘         
« q_2: ┤ cut_2 ├──────────────────
«      └───────┘                  
« q_3: ───────────────────────────
«                                 
« q_4: ───────────────────────────
«                                 
« q_5: ───────────────────────────
«                                 
« q_6: ───────────────────────────
«                                 
« q_7: ───────────────────────────
«                                 
« q_8: ───────────────────────────
«                                 
« q_9: ───────────────────────────
«                                 
«q_10: ───────────────────────────
«                                 
«q_11: ───────────────────────────
«                                 
«q_12: ───────────────────────────
«                                 
«q_13: ───────────────────────────
«                                 
«q_14: ───────────────────────────
«                                 
                                                                        »
q_0: ───────────────────────────────────────────────────────────────────»
                                                                        »
q_1: ───────────────────────────────────────────────────────────────────»
                                                                        »
q_2: ───────────────────────────────────────────────────────────────────»
                                                                        »
q_3: ───────────────────────────────────────■──────────────────■────────»
                                            │                  │        »
q_4: ──────────■─────────■─────────■────────┼─────────■────────┼────────»
     ┌───────┐ │         │         │        │         │        │        »
q_5: ┤ cut_4 ├─┼─────────┼─────────┼────────┼─────────┼────────┼────────»
     ├───────┤ │         │         │        │         │P(π/4)  │        »
q_6: ┤ cut_3 ├─┼─────────┼─────────┼────────┼─────────■────────┼────────»
     ├───────┤ │         │         │P(π/8)  │                  │P(π/16) »
q_7: ┤ cut_2 ├─┼─────────┼─────────■────────┼──────────────────■────────»
     ├───────┤ │         │P(π/16)           │P(π/32)                    »
q_8: ┤ cut_1 ├─┼─────────■──────────────────■───────────────────────────»
     ├───────┤ │P(π/32)                                                 »
q_9: ┤ cut_0 ├─■────────────────────────────────────────────────────────»
     └───────┘                                                          »
«                                                                           »
«q_0: ──────────────────────────────────────────────────────────────────────»
«                                                                           »
«q_1: ──────────────────────────────────────────────────────────────────────»
«                                                                           »
«q_2: ───────────────────■───────────────────────■──────────────────■───────»
«                        │                       │                  │       »
«q_3: ──────────■────────┼──────────────■────────┼─────────■────────┼───────»
«               │        │        ┌───┐ │        │         │P(π/2)  │       »
«q_4: ─■────────┼────────┼────────┤ H ├─┼────────┼─────────■────────┼───────»
«      │P(π/2)  │        │        └───┘ │P(π/4)  │                  │P(π/8) »
«q_5: ─■────────┼────────┼──────────────■────────┼──────────────────■───────»
«               │P(π/8)  │                       │P(π/16)                   »
«q_6: ──────────■────────┼───────────────────────■──────────────────────────»
«                        │P(π/32)                                           »
«q_7: ───────────────────■──────────────────────────────────────────────────»
«                                                                           »
«q_8: ──────────────────────────────────────────────────────────────────────»
«                                                                           »
«q_9: ──────────────────────────────────────────────────────────────────────»
«                                                                           »
«                                                                        »
«q_0: ─────────────────────────────────────────────────────■─────────────»
«                                                          │             »
«q_1: ─■───────────────────────■──────────────────■────────┼─────────────»
«      │                       │                  │        │        ┌───┐»
«q_2: ─┼──────────────■────────┼─────────■────────┼────────┼────────┤ H ├»
«      │        ┌───┐ │        │         │P(π/2)  │        │        └───┘»
«q_3: ─┼────────┤ H ├─┼────────┼─────────■────────┼────────┼─────────────»
«      │        └───┘ │P(π/4)  │                  │P(π/8)  │             »
«q_4: ─┼──────────────■────────┼──────────────────■────────┼─────────────»
«      │                       │P(π/16)                    │P(π/32)      »
«q_5: ─┼───────────────────────■───────────────────────────■─────────────»
«      │P(π/32)                                                          »
«q_6: ─■─────────────────────────────────────────────────────────────────»
«                                                                        »
«q_7: ───────────────────────────────────────────────────────────────────»
«                                                                        »
«q_8: ───────────────────────────────────────────────────────────────────»
«                                                                        »
«q_9: ───────────────────────────────────────────────────────────────────»
«                                                                        »
«                                                                 ┌───┐
«q_0: ──────────■──────────────────■─────────────■────────■───────┤ H ├
«               │                  │       ┌───┐ │        │P(π/2) └───┘
«q_1: ─■────────┼─────────■────────┼───────┤ H ├─┼────────■────────────
«      │        │         │P(π/2)  │       └───┘ │P(π/4)               
«q_2: ─┼────────┼─────────■────────┼─────────────■─────────────────────
«      │P(π/4)  │                  │P(π/8)                             
«q_3: ─■────────┼──────────────────■───────────────────────────────────
«               │P(π/16)                                               
«q_4: ──────────■──────────────────────────────────────────────────────
«                                                                      
«q_5: ─────────────────────────────────────────────────────────────────
«                                                                      
«q_6: ─────────────────────────────────────────────────────────────────
«                                                                      
«q_7: ─────────────────────────────────────────────────────────────────
«                                                                      
«q_8: ─────────────────────────────────────────────────────────────────
«                                                                      
«q_9: ─────────────────────────────────────────────────────────────────
«                                                                      
[{'input': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'output': ['cut_4', 'cut_3', 'cut_2', 'cut_1', 'cut_0', None, None, None, None, None, None, None, None, None, None], 'counter': {'rho': 0, 'O': 5, 'effective': 10}, 'p_cuts': {}, 'm_cuts': {0: 'cut_4', 1: 'cut_3', 2: 'cut_2', 3: 'cut_1', 4: 'cut_0'}, 'num_qubits': 15}, {'input': [None, None, None, None, None, 'cut_4', 'cut_3', 'cut_2', 'cut_1', 'cut_0'], 'output': [None, None, None, None, None, None, None, None, None, None], 'counter': {'rho': 5, 'O': 0, 'effective': 10}, 'p_cuts': {5: 'cut_4', 6: 'cut_3', 7: 'cut_2', 8: 'cut_1', 9: 'cut_0'}, 'm_cuts': {}, 'num_qubits': 10}]
{'cuts': {'cut_0': [(0, 4), (1, 9)], 'cut_1': [(0, 3), (1, 8)], 'cut_2': [(0, 2), (1, 7)], 'cut_3': [(0, 1), (1, 6)], 'cut_4': [(0, 0), (1, 5)]}, 'num_subcircuits': 2, 'num_qubits': 20, 'num_cuts': 5, 'cut_index': {'cut_0': 0, 'cut_1': 1, 'cut_2': 2, 'cut_3': 3, 'cut_4': 4}}
--> Generating subcircuit entries:
Subcircuit 0 has 243 entries.
Subcircuit 1 has 1024 entries.
--> Running Prior Samples
--> Building output probability
-----> Reading data
Traceback (most recent call last):
  File "/home/b10901076/ShotQC/aqft.py", line 43, in <module>
    shotqc.reconstruct(batch_size=2**19)
  File "/home/b10901076/ShotQC/shotqc/main.py", line 137, in reconstruct
    self.output_prob = parallel_reconstruct(self.params, args, batch_size=batch_size)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b10901076/ShotQC/shotqc/parallel_overhead_v2.py", line 665, in parallel_reconstruct
    subcircuit_value, lined_prob_coef = calc_subcircuit_value(
                                        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b10901076/ShotQC/shotqc/parallel_overhead_v2.py", line 497, in calc_subcircuit_value
    used_probs = permuted_probs[(slice(None),) + indices].permute(final_permute_order).contiguous()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 15.19 GiB. GPU 0 has a total capacity of 15.72 GiB of which 245.88 MiB is free. Including non-PyTorch memory, this process has 15.45 GiB memory in use. Of the allocated memory 15.25 GiB is allocated by PyTorch, and 17.25 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
